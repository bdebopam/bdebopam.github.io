{"version":3,"file":"index.js","sources":["../src/useCustomScroller.js","../node_modules/style-inject/dist/style-inject.es.js","../src/index.js"],"sourcesContent":["import { useLayoutEffect, useRef, useState, useCallback } from 'react';\n\n/**\n * We use a negative right on the content to hide original OS scrollbars\n */\nconst OS_SCROLLBAR_WIDTH = (() => {\n  const outer = document.createElement('div');\n  const inner = document.createElement('div');\n  outer.style.overflow = 'scroll';\n  outer.style.width = '100%';\n  inner.style.width = '100%';\n\n  document.body.appendChild(outer);\n  outer.appendChild(inner);\n  const scrollbarWidth = outer.offsetWidth - inner.offsetWidth;\n  outer.removeChild(inner);\n  document.body.removeChild(outer);\n\n  return scrollbarWidth;\n})();\n\n/**\n * We need this for OSs that automatically hide the scrollbar (so the offset\n * doesn't change in such case). Eg: macOS with \"Automatically based on mouse\".\n */\nconst SCROLLBAR_WIDTH = OS_SCROLLBAR_WIDTH || 20;\n\n/**\n * Ported from Vitor's SimpleScrollbar library (vanilla JS):\n * https://github.com/buzinas/simple-scrollbar\n * @param {React.ReactNode} content Used as a dependency to re-run the effect\n * @param {React.MutableRefObject} [customRef]\n * @param {Object} [options={}]\n * @param {boolean} [options.disabled]\n */\nexport default function useCustomScroller(\n  content,\n  customRef,\n  { disabled } = {},\n) {\n  const [scrollRatio, setScrollRatio] = useState(1);\n  const [isDraggingTrack, setIsDraggingTrack] = useState(false);\n\n  const ref = useRef();\n  const scrollerRef = customRef || ref;\n  const trackRef = useRef();\n  const trackAnimationRef = useRef();\n  const memoizedProps = useRef({});\n\n  useLayoutEffect(() => {\n    const el = scrollerRef.current;\n    let scrollbarAnimation;\n\n    const updateScrollbar = () => {\n      cancelAnimationFrame(scrollbarAnimation);\n      scrollbarAnimation = requestAnimationFrame(() => {\n        const { clientHeight, scrollHeight } = el;\n        setScrollRatio(clientHeight / scrollHeight);\n        memoizedProps.current = {\n          clientHeight,\n          scrollHeight,\n          trackHeight: trackRef.current.clientHeight,\n        };\n      });\n    };\n\n    window.addEventListener('resize', updateScrollbar);\n    updateScrollbar();\n\n    return () => {\n      cancelAnimationFrame(scrollbarAnimation);\n      window.removeEventListener('resize', updateScrollbar);\n    };\n  }, [scrollerRef, content]);\n\n  useLayoutEffect(() => {\n    if (!disabled) return;\n    const el = scrollerRef.current;\n\n    const onWheel = e => e.preventDefault();\n    el.addEventListener('wheel', onWheel, { passive: false });\n\n    return () => {\n      el.removeEventListener('wheel', onWheel);\n    };\n  }, [scrollerRef, disabled]);\n\n  const onScroll = useCallback(() => {\n    if (scrollRatio === 1) return;\n    const el = scrollerRef.current;\n    const track = trackRef.current;\n\n    cancelAnimationFrame(trackAnimationRef.current);\n\n    trackAnimationRef.current = requestAnimationFrame(() => {\n      const { clientHeight, scrollHeight, trackHeight } = memoizedProps.current;\n      const ratio = el.scrollTop / (scrollHeight - clientHeight);\n      const y = ratio * (clientHeight - trackHeight);\n      track.style.transform = `translateY(${y}px)`;\n    });\n  }, [scrollerRef, scrollRatio]);\n\n  const moveTrack = useCallback(\n    e => {\n      const el = scrollerRef.current;\n      let moveAnimation;\n      let lastPageY = e.pageY;\n      let lastScrollTop = el.scrollTop;\n\n      setIsDraggingTrack(true);\n\n      const drag = ({ pageY }) => {\n        cancelAnimationFrame(moveAnimation);\n        moveAnimation = requestAnimationFrame(() => {\n          const delta = pageY - lastPageY;\n          lastScrollTop += delta / scrollRatio;\n          lastPageY = pageY;\n          el.scrollTop = lastScrollTop;\n        });\n      };\n\n      const stop = () => {\n        setIsDraggingTrack(false);\n        window.removeEventListener('mousemove', drag);\n      };\n\n      window.addEventListener('mousemove', drag);\n      window.addEventListener('mouseup', stop, { once: true });\n    },\n    [scrollerRef, scrollRatio],\n  );\n\n  const wrapperProps = {\n    style: {\n      marginLeft: `-${SCROLLBAR_WIDTH}px`,\n    },\n  };\n\n  const scrollerProps = {\n    ref: scrollerRef,\n    onScroll: disabled ? undefined : onScroll,\n    style: {\n      right: `-${SCROLLBAR_WIDTH}px`,\n      padding: `0 ${SCROLLBAR_WIDTH}px 0 0`,\n      width: `calc(100% + ${OS_SCROLLBAR_WIDTH}px)`,\n    },\n  };\n\n  const trackProps = {\n    ref: trackRef,\n    onMouseDown: disabled ? undefined : moveTrack,\n    style: {\n      right: isDraggingTrack ? 1 : undefined,\n      width: isDraggingTrack ? 10 : undefined,\n      height: `${scrollRatio * 100}%`,\n      opacity: isDraggingTrack ? 1 : undefined,\n      display: disabled || scrollRatio === 1 ? 'none' : undefined,\n    },\n  };\n\n  return [wrapperProps, scrollerProps, trackProps];\n}\n","function styleInject(css, ref) {\n  if ( ref === void 0 ) ref = {};\n  var insertAt = ref.insertAt;\n\n  if (!css || typeof document === 'undefined') { return; }\n\n  var head = document.head || document.getElementsByTagName('head')[0];\n  var style = document.createElement('style');\n  style.type = 'text/css';\n\n  if (insertAt === 'top') {\n    if (head.firstChild) {\n      head.insertBefore(style, head.firstChild);\n    } else {\n      head.appendChild(style);\n    }\n  } else {\n    head.appendChild(style);\n  }\n\n  if (style.styleSheet) {\n    style.styleSheet.cssText = css;\n  } else {\n    style.appendChild(document.createTextNode(css));\n  }\n}\n\nexport default styleInject;\n","import React, { forwardRef } from 'react';\nimport PropTypes from 'prop-types';\n\nimport useCustomScroller from './useCustomScroller';\n\nimport styles from './index.module.css';\n\nconst cx = (...args) => args.filter(Boolean).join(' ');\n\nconst CustomScroller = forwardRef(\n  ({ scrollDisabled, className, innerClassName, children, ...props }, ref) => {\n    const [wrapperProps, scrollerProps, trackProps] = useCustomScroller(\n      children,\n      ref,\n      { disabled: scrollDisabled },\n    );\n\n    return (\n      <div className={cx(className, styles.main)} {...props}>\n        <div className={styles.wrapper} {...wrapperProps}>\n          <div className={cx(innerClassName, styles.inner)} {...scrollerProps}>\n            {children}\n          </div>\n        </div>\n        <div className={styles.track} {...trackProps} />\n      </div>\n    );\n  },\n);\n\nCustomScroller.propTypes = {\n  scrollDisabled: PropTypes.bool,\n  innerClassName: PropTypes.string,\n  className: PropTypes.string,\n  children: PropTypes.node.isRequired,\n};\n\nCustomScroller.displayName = 'CustomScroller';\n\nexport default CustomScroller;\n"],"names":["OS_SCROLLBAR_WIDTH","outer","document","createElement","inner","style","overflow","width","body","appendChild","scrollbarWidth","offsetWidth","removeChild","SCROLLBAR_WIDTH","useCustomScroller","content","customRef","disabled","useState","scrollRatio","setScrollRatio","isDraggingTrack","setIsDraggingTrack","ref","useRef","scrollerRef","trackRef","trackAnimationRef","memoizedProps","useLayoutEffect","el","current","scrollbarAnimation","updateScrollbar","cancelAnimationFrame","requestAnimationFrame","clientHeight","scrollHeight","trackHeight","window","addEventListener","removeEventListener","onWheel","e","preventDefault","passive","onScroll","useCallback","track","ratio","scrollTop","y","transform","moveTrack","moveAnimation","lastPageY","pageY","lastScrollTop","drag","delta","stop","once","wrapperProps","marginLeft","scrollerProps","undefined","right","padding","trackProps","onMouseDown","height","opacity","display","cx","args","filter","Boolean","join","CustomScroller","forwardRef","scrollDisabled","className","innerClassName","children","props","React","styles","main","wrapper","propTypes","PropTypes","bool","string","node","isRequired","displayName"],"mappings":"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"}